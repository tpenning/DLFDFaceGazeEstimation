import math

import matplotlib.pyplot as plt


def plot_losses(train_l1_losses, train_angular_losses, eval1_l1_losses, eval1_angular_losses,
                calibration_l1_losses, calibration_angular_losses, eval2_l1_losses, eval2_angular_losses):
    # Pack the data in arrays to easily access them
    train_cal = [train_l1_losses, train_angular_losses, calibration_l1_losses, calibration_angular_losses]
    eval12 = [eval1_l1_losses, eval1_angular_losses, eval2_l1_losses, eval2_angular_losses]

    # Plot titles and labels
    plot_titles = ["Training L1 Loss", "Training Angular Loss", "Calibration L1 Loss", "Calibration Angular Loss"]
    line_labels = ["Train", "Cal"]
    loss_metric_labels = ["L1 loss", "Angular loss"]

    # Create four subplots
    fig, axs = plt.subplots(nrows=2, ncols=2, figsize=(10, 10))

    # Add the data for the plots
    for i in range(4):
        pi = format(i, '02b')
        plot = axs[int(pi[0]), int(pi[1])]

        plot.plot(train_cal[i], "b-", label=line_labels[math.floor(i / 2)])
        plot.plot(eval12[i], "orange", label="Val")
        plot.set_title(plot_titles[i])
        plot.set_xlabel("Epoch")
        plot.set_ylabel(loss_metric_labels[i % 2])
        plot.legend()

    # Show the plots
    plt.tight_layout()
    plt.show()


if __name__ == "__main__":
    train_l1 = [0.13445948394523424, 0.12608415963636202, 0.1259170834991065, 0.12603675116869537, 0.12586824578995054,
                0.12579804794354874, 0.12572637242688375, 0.12572069372981787, 0.12558588580313054, 0.12546890381384979,
                0.12578295552256433, 0.12567759279839016, 0.12584995579990474, 0.1255426307801496, 0.1257127212699164,
                0.1256943577900529, 0.12730962139638988, 0.1258132147010077, 0.12615282283249227, 0.12613253540952096]
    train_ang = [11.986868067221208, 11.152939720587296, 11.145299575545572, 11.150183710184963, 11.130962068384344,
                 11.129956039515408, 11.115083889527755, 11.127294963056391, 11.108337716622787, 11.101465160196478,
                 11.127795089374889, 11.115562395616012, 11.140969850800253, 11.1097830100493, 11.118872490796177,
                 11.116213527592747, 11.249720508402044, 11.128357583826238, 11.15462425622073, 11.16199867291884]

    eval1_l1 = [0.1403622254729271, 0.13920064146320024, 0.14270557463169098, 0.14044896761576334, 0.14131306360165277,
                0.14101269592841467, 0.14081298063198724, 0.1406457225481669, 0.1402441238363584, 0.14083642264207205,
                0.14232936749855676, 0.14101962745189667, 0.1387473319967588, 0.14199901123841605, 0.14351669947306314,
                0.14283912380536398, 0.14202958593765894, 0.14356799920399985, 0.14166883627573648, 0.14189718663692474]
    eval1_ang = [12.552679538726807, 12.504053592681885, 12.886366208394369, 12.627068042755127, 12.718688170115152,
                 12.698859055836996, 12.649685541788736, 12.626344362894693, 12.574971040089926, 12.674175262451172,
                 12.80424133936564, 12.68091599146525, 12.434197107950846, 12.777262528737387, 12.946820576985678,
                 12.852178255716959, 12.764022668202719, 12.941431522369385, 12.745577494303385, 12.751609325408936]

    calib_l1 = [0.15681052207946777, 0.15600106120109558, 0.15458257496356964, 0.1480879932641983, 0.14844770729541779,
                0.1446031928062439, 0.1465253382921219, 0.15787330269813538, 0.14971232414245605, 0.14736202359199524,
                0.14664636552333832, 0.1436173915863037, 0.1459498405456543, 0.14348573982715607, 0.13983409106731415,
                0.14014294743537903, 0.14042989909648895, 0.1426297128200531, 0.13957352936267853, 0.14031103253364563,
                0.13916990160942078, 0.1415659338235855, 0.13605915009975433, 0.14299960434436798, 0.13939268887043,
                0.14453279972076416, 0.13966113328933716, 0.14077186584472656, 0.14033527672290802, 0.13882620632648468,
                0.14059028029441833, 0.14232054352760315, 0.14161716401576996, 0.14078496396541595, 0.141565203666687,
                0.13999831676483154, 0.14085710048675537, 0.14046932756900787, 0.1405789703130722, 0.14279474318027496,
                0.14208252727985382, 0.13832417130470276, 0.14056287705898285, 0.1408408135175705, 0.13799133896827698,
                0.14115363359451294, 0.13945600390434265, 0.1403232365846634, 0.14281567931175232, 0.1387164443731308,
                0.1387418806552887, 0.13318470120429993, 0.15081337094306946, 0.1379874348640442, 0.1418417990207672,
                0.14290864765644073, 0.14251653850078583, 0.1412733793258667, 0.14230811595916748, 0.1420576423406601,
                0.21643491089344025, 0.14256644248962402, 0.14052729308605194, 0.13962212204933167, 0.13972435891628265,
                0.1392792910337448, 0.13581855595111847, 0.13635633885860443, 0.13220004737377167, 0.13584622740745544,
                0.13101835548877716, 0.13661816716194153, 0.13324080407619476, 0.13761888444423676, 0.13758908212184906,
                0.13638535141944885, 0.13550196588039398, 0.1339469999074936, 0.13301704823970795, 0.13488607108592987,
                0.1329851597547531, 0.13268153369426727, 0.13412518799304962, 0.13350151479244232, 0.130450040102005,
                0.12592580914497375, 0.12794341146945953, 0.12753252685070038, 0.12874484062194824, 0.12794166803359985,
                0.12613597512245178, 0.13126255571842194, 0.12679345905780792, 0.12383478134870529, 0.12960083782672882,
                0.12674391269683838, 0.12647037208080292, 0.13039104640483856, 0.13287952542304993, 0.12395453453063965]
    calib_ang = [14.339935302734375, 14.188015937805176, 13.965832710266113, 13.4461030960083, 13.3352632522583,
                 12.864908218383789, 13.077681541442871, 14.275662422180176, 13.568948745727539, 13.311431884765625,
                 13.236990928649902, 13.013124465942383, 13.198451042175293, 12.853291511535645, 12.399234771728516,
                 12.446361541748047, 12.501143455505371, 12.745783805847168, 12.41553783416748, 12.449885368347168,
                 12.333104133605957, 12.616262435913086, 12.151358604431152, 12.602315902709961, 12.333296775817871,
                 12.761417388916016, 12.461663246154785, 12.520794868469238, 12.53370475769043, 12.364306449890137,
                 12.44410514831543, 12.663290977478027, 12.56131649017334, 12.51947021484375, 12.5512113571167,
                 12.481647491455078, 12.55670166015625, 12.449174880981445, 12.480010032653809, 12.55677318572998,
                 12.62757682800293, 12.336956977844238, 12.512432098388672, 12.48420238494873, 12.304671287536621,
                 12.57160472869873, 12.321118354797363, 12.535195350646973, 12.656706809997559, 12.287431716918945,
                 12.296072006225586, 11.796775817871094, 13.582971572875977, 12.328478813171387, 12.758565902709961,
                 12.914979934692383, 12.865518569946289, 12.669977188110352, 12.662116050720215, 12.701303482055664,
                 18.527135848999023, 12.796923637390137, 12.60483169555664, 12.599037170410156, 12.537933349609375,
                 12.504858016967773, 12.097793579101562, 12.121748924255371, 11.864949226379395, 12.154648780822754,
                 11.775857925415039, 12.307229995727539, 12.030329704284668, 12.295099258422852, 12.328424453735352,
                 12.205487251281738, 12.177496910095215, 12.040604591369629, 11.83403205871582, 11.965266227722168,
                 11.815826416015625, 11.850170135498047, 12.016120910644531, 11.98258113861084, 11.64909839630127,
                 11.234551429748535, 11.545013427734375, 11.426398277282715, 11.45814323425293, 11.52165699005127,
                 11.27354621887207, 11.605606079101562, 11.253530502319336, 11.137639045715332, 11.62757396697998,
                 11.318883895874023, 11.214606285095215, 11.587943077087402, 11.912457466125488, 11.084623336791992]

    eval2_l1 = [0.13970246662696204, 0.1381638174255689, 0.1368756890296936, 0.13471350322167078, 0.14023834466934204,
                0.14917197078466415, 0.1480664685368538, 0.14156547685464224, 0.13674700011809668, 0.13469112912813822,
                0.1345843474070231, 0.13482441753149033, 0.13433045024673143, 0.13726689169804254, 0.14021652936935425,
                0.1408443252245585, 0.14194170633951822, 0.14060199509064356, 0.13949099679787955, 0.13809430599212646,
                0.13881655285755792, 0.13759910563627878, 0.13825201988220215, 0.13852886855602264, 0.1420154795050621,
                0.1401772623260816, 0.13752983510494232, 0.1380452240506808, 0.1379763459165891, 0.13787582516670227,
                0.1388033019999663, 0.13815511266390482, 0.13775464644034704, 0.13824212551116943, 0.13889485597610474,
                0.13863316426674524, 0.13927095383405685, 0.13740905622641245, 0.13963995625575384, 0.13862846791744232,
                0.1390681341290474, 0.13826070725917816, 0.13835396120945612, 0.13906553387641907, 0.13903270661830902,
                0.14149965594212213, 0.13937568416198096, 0.13948684185743332, 0.13799954454104105, 0.14082534362872443,
                0.14213122179110846, 0.18089121331771216, 0.137057031194369, 0.1353360116481781, 0.13447705656290054,
                0.1344514861702919, 0.13471893966197968, 0.13578907400369644, 0.135965829094251, 0.19953886419534683,
                0.1401111955444018, 0.13692371795574823, 0.1357704314092795, 0.13539654513200125, 0.13744873801867166,
                0.13911583026250204, 0.14292675505081812, 0.13861827552318573, 0.1410868987441063, 0.14099844048420587,
                0.15732717017332712, 0.14037859936555228, 0.1359287053346634, 0.13453969359397888, 0.1355100820461909,
                0.13550815731287003, 0.13701292499899864, 0.14092788100242615, 0.14571074644724527, 0.14437772830327353,
                0.1386065830787023, 0.13869450986385345, 0.138089028497537, 0.1387309767305851, 0.13979693005482355,
                0.14284482349952063, 0.1441278283794721, 0.14042170345783234, 0.1424580216407776, 0.14306244254112244,
                0.14653887103001276, 0.15094966441392899, 0.14215939740339914, 0.13815394788980484, 0.1377958059310913,
                0.1414879485964775, 0.15233563631772995, 0.16074228038390478, 0.1474367082118988, 0.1424317235747973]
    eval2_ang = [12.572826067606607, 12.401429494222006, 12.259617328643799, 12.032474835713705, 12.485899607340494,
                 13.276879946390787, 13.233892440795898, 12.659950574239096, 12.265449523925781, 12.051148732503256,
                 12.048043727874756, 12.041425228118896, 11.999439239501953, 12.258957227071127, 12.519742965698242,
                 12.573244253794352, 12.690940539042154, 12.53990888595581, 12.439482688903809, 12.31689421335856,
                 12.386161963144938, 12.298397223154703, 12.354282855987549, 12.369239012400309, 12.70222250620524,
                 12.538551966349283, 12.302419503529867, 12.324701309204102, 12.323967138926188, 12.30585797627767,
                 12.4174911181132, 12.344923814137777, 12.331780274709066, 12.360336621602377, 12.411165873209635,
                 12.400130907694498, 12.442591826121012, 12.300150871276855, 12.466526508331299, 12.397425969441732,
                 12.447835763295492, 12.374648253122965, 12.396255493164062, 12.429571151733398, 12.429100036621094,
                 12.666595935821533, 12.452435175577799, 12.474324544270834, 12.320032596588135, 12.600307782491049,
                 12.725686232248941, 16.524381796518963, 12.21402390797933, 12.061406771341959, 11.99642531077067,
                 11.995412667592367, 12.050450642903646, 12.134126822153727, 12.153491020202637, 17.291858673095703,
                 12.560237566630045, 12.234283606211344, 12.140630880991617, 12.099680264790853, 12.292224407196045,
                 12.490515549977621, 12.805205980936686, 12.427790323893229, 12.662635644276937, 12.617259661356607,
                 14.28702704111735, 12.55981969833374, 12.149828592936197, 12.016625563303629, 12.107120990753174,
                 12.093099594116211, 12.250365734100342, 12.625386238098145, 13.069617112477621, 12.935815811157227,
                 12.387346585591635, 12.408904552459717, 12.360615889231363, 12.415083408355713, 12.500389099121094,
                 12.842602411905924, 12.937157789866129, 12.573983987172445, 12.826714038848877, 12.867849667867025,
                 13.191105206807455, 13.653581937154135, 12.776825745900473, 12.342775503794352, 12.293986797332764,
                 12.684241135915121, 13.775335470835367, 14.564392566680908, 13.305072784423828, 12.804311593373617]

    plot_losses(train_l1, train_ang, eval1_l1, eval1_ang, calib_l1, calib_ang, eval2_l1, eval2_ang)
